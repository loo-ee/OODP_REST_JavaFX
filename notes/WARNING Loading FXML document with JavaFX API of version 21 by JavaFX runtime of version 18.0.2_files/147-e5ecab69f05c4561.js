"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[147],{5352:function(e,t,n){var o=n(85893),r=n(67294),a=n(99017),s=n(82010),c=n(33299),l=n(78543),i=n(3176);t.Z=function(e){var t;let{show:n,setShow:u}=e,d=()=>u(!1),{data:h}=(0,c.useSession)(),[f,m]=(0,r.useState)([]),p=null==h?void 0:null===(t=h.user)||void 0===t?void 0:t.userId;(0,r.useEffect)(()=>{if(p&&n){let e=[(0,i.Gg)().then(e=>e.json()),(0,i.f3)().then(e=>e.json())];Promise.all(e).then(e=>{let[t,n]=e,o=t.map(e=>({title:e.title,url:"".concat("/agent","?cache=").concat(e.id),timestamp:new Date(e.updatedAt).getTime(),queries:[]})),r=n.map(e=>({title:e.title,url:"".concat("/search","?cache=").concat(e.id),timestamp:new Date(e.updatedAt).getTime(),queries:[]})),a=[...o,...r];a.sort((e,t)=>t.timestamp-e.timestamp),m(a)})}},[p,n]);let[x,b]=(0,r.useState)(!1);(0,r.useEffect)(()=>{b(!0)},[]);let g=(e,t)=>{l.n.track("Click Thread History",{threadTitle:f[e].title,url:t}),window.location.href=t},y=e=>{if(window.confirm("Are you sure you wish to delete this item?")){l.n.track("Delete individual thread");let t=f[e],n=t.url.split("=")[1];(0,i.do)(n).then(()=>{let t=[...f];t.splice(e,1),m(t)})}},w=()=>{p&&window.confirm("Are you sure you wish to clear your history?")&&(0,i.do)().then(()=>{window.location.href="/"})},j=()=>{window.location.href="/"},{resolvedTheme:k}=(0,s.F)(),v="dark"===k?"#575a7b":"#e6f0fd",[N,S]=(0,r.useState)({});return(0,o.jsx)(a.Z,{show:n,onHide:d,children:(0,o.jsx)(a.Z.Dialog,{className:"d-flex align-items-center justify-content-center m-0 vh-90",style:{minWidth:"98%",maxWidth:"150%",borderRadius:"100px"},children:(0,o.jsxs)(a.Z.Body,{className:"bg-white border border-history-panel rounded-2 pt-4 px-7",children:[(0,o.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,o.jsx)(a.Z.Title,{className:"p-0 fs-4",children:"History"}),(0,o.jsx)("button",{className:"btn btn-sm fs-3",type:"submit",onClick:d,children:(0,o.jsx)("i",{className:"mx-2 fe fe-x darkmode-img"})})]}),x&&!!f.length&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"col mt-3",style:{borderBottom:"1px solid ".concat(v)}}),(0,o.jsx)("div",{className:"container p-0",style:{overflowY:"scroll",maxHeight:"65vh"},children:f.map((e,t)=>{let{title:n,url:r,timestamp:a}=e,s=new Date(a).toLocaleString();return(0,o.jsx)("div",{className:"col mt-2",style:t===f.length-1?{}:{borderBottom:"1px solid ".concat(v)},children:(0,o.jsx)("div",{className:"card shadow-none transparent-card",onClick:()=>g(t,r),children:(0,o.jsxs)("div",{className:"card-body p-4 fs-4",onMouseEnter:e=>{e.currentTarget.style.color="#687DED",e.currentTarget.style.cursor="pointer",S(e=>({...e,[t]:!0}))},onMouseLeave:e=>{e.currentTarget.style.color="",e.currentTarget.style.cursor="default",S(e=>({...e,[t]:!1}))},children:[n.substring(0,256),N[t]&&(0,o.jsx)("div",{style:{position:"absolute",right:"20px",top:"50%",transform:"translateY(-50%)"},children:(0,o.jsx)("i",{className:"fe fe-trash m-1",onClick:e=>{e.stopPropagation(),y(t)}})}),(0,o.jsx)("div",{className:"fs-6",children:s})]})})},"".concat(a))})}),(0,o.jsxs)("div",{style:{position:"absolute",right:35,bottom:0},children:[(0,o.jsxs)("button",{className:"btn fs-5 p-0 my-4 mx-2 fw-bold text-dark",type:"button",onClick:()=>{w()},children:[(0,o.jsx)("i",{className:"fe fe-trash m-2"}),"Clear conversations"]}),(0,o.jsxs)("button",{className:"btn fs-5 p-0 my-4 mx-2 fw-bold text-dark",type:"button",onClick:()=>{j()},children:[(0,o.jsx)("i",{className:"fe fe-plus m-2"}),"New thread"]})]})]}),x&&!h&&(0,o.jsx)("p",{className:"m-0",children:"Please sign in to view your chat history."})]})})})}},37870:function(e,t,n){var o=n(85893),r=n(67294),a=n(12372),s=n(96769),c=n(65629),l=n(78543),i=n(48684);function u(e){let{placeholder:t,initialQuestionFromCache:n,defaultNumRowsToShow:u,customSearchHandler:d,children:h,initialContext:f,loading:m,answerModel:p,maxTokenLimit:x=a.M9}=e,[b,g]=(0,r.useState)(n),[y,w]=(0,r.useState)(f),[j,k]=(0,r.useState)(!!f),v=(0,r.useRef)(null),N=(0,r.useRef)(null);function S(e){if(null==e?void 0:e.current){let t=e.current;t.style.height="auto";let n=Math.min(t.scrollHeight,512);t.style.height="".concat(n,"px")}}(0,r.useEffect)(()=>{S(v),S(N)},[v,b,N,y]);let C=e=>{"Tab"===e.key&&k(!0),e.shiftKey&&"Enter"===e.key||"Enter"!==e.key||(e.preventDefault(),T(e))},T=async e=>{if(e.preventDefault(),m)return;let t=b.trim(),n=y?"&c=".concat(encodeURIComponent(y)):"";if(""!==t){if(I>=a.$x){let e=(0,s.yF)(t,x,p),n=(0,s.yF)(y,x-(0,s.In)(e,p),p);localStorage.setItem("long-question",e),localStorage.setItem("long-context",n)}l.n.track("Searchbox Submit",{question:t,context:y}),d?await d(t,y,p):I>=a.$x?window.location.href="/search?source=searchbox":window.location.href="/search?q=".concat(encodeURIComponent(b)).concat(n,"&source=searchbox")}},P=e=>{let t=e.target.value;g(t),t.length>=64&&k(!0)},I=b.length+y.length,R=(0,s.In)("".concat(b,"\n").concat(y),p),{isXs:Z}=(0,i.k)(),E=Z?"on":"off";return(0,o.jsxs)("form",{className:"mb-3",onSubmit:e=>T(e),children:[(0,o.jsxs)("div",{className:"input-group shadow darkmode-light position-relative search-bar-input-group",children:[(0,o.jsx)("div",{style:{content:'""',position:"absolute",top:"-4px",left:"-5px",right:"-5px",bottom:"-4px",zIndex:"-1",background:"linear-gradient(to right, #ED6E61, #6359E1)",borderRadius:"13px"}}),(0,o.jsx)("textarea",{tabIndex:0,ref:v,autoFocus:!0,autoComplete:"off",autoCorrect:E,autoCapitalize:"off",spellCheck:"false",name:"q",className:"form-control bg-white darkmode-light searchbox-textarea search-bar-hide-scrollbar",rows:u,placeholder:t,"aria-label":t,style:{resize:"none",height:"auto",borderRadius:"10px"},onKeyDown:C,onChange:P,value:b}),(0,o.jsxs)("div",{className:"btn-group shadow-none bg-white-grey",style:{borderRadius:"10px"},children:[(0,o.jsx)(c.Z,{message:"Advanced Search",children:(0,o.jsx)("button",{className:"btn p-2 rounded-0",type:"button",onClick:()=>{y||k(!j)},children:j||y?(0,o.jsx)("i",{className:"fe fe-chevron-up text-black"}):(0,o.jsx)("i",{className:"fe fe-chevron-down text-black"})})}),(0,o.jsx)("button",{className:"btn p-2 rounded-0",type:"submit",children:(0,o.jsx)("i",{className:"fe fe-search text-black"})}),R>64&&(0,o.jsx)("button",{className:"fs-6 text-dark",type:"button",style:{position:"absolute",bottom:"0",right:"0",background:"none",border:"none",cursor:"none",WebkitUserSelect:"none",msUserSelect:"none",userSelect:"none",zIndex:100},disabled:!0,children:(0,o.jsxs)("div",{className:R>=x?"text-danger":"text-dark",children:[R,"/",x," ",R>=x&&"(will be truncated)"]})})]})]}),j&&(0,o.jsx)("div",{className:"input-group shadow darkmode-light mt-5",children:(0,o.jsx)("textarea",{tabIndex:0,ref:N,autoComplete:"off",autoCorrect:E,autoCapitalize:"off",spellCheck:"false",name:"c",className:"form-control bg-white darkmode-light searchbox-textarea",rows:u,placeholder:"Put any extra code or context here.","aria-label":t,style:{resize:"none",height:"auto"},onKeyDown:C,onChange:e=>{w(e.target.value)},value:y})}),h]})}u.defaultProps={customSearchHandler:null,children:null,loading:!1,maxTokenLimit:a.M9},t.Z=u},96769:function(e,t,n){n.d(t,{$j:function(){return g},Ih:function(){return b},In:function(){return w},Mz:function(){return l},N6:function(){return i},N7:function(){return y},Uj:function(){return c},V7:function(){return m},XD:function(){return p},Yg:function(){return f},_P:function(){return u},hC:function(){return d},xs:function(){return h},yF:function(){return j}});var o=n(21870),r=n(88531),a=n(64487),s=n(12372);async function*c(e){let t=e.getReader();try{for(;;){let{done:e,value:n}=await t.read();if(e)return;yield n}}catch(e){console.error(e),a.Tb(e)}finally{t.releaseLock()}}let l=(e,t)=>{let n=e.getReader();return new ReadableStream({async start(e){for(;;){if(t.aborted){n.cancel(),e.close();return}let{done:o,value:r}=await n.read();if(o){e.close();return}e.enqueue(r)}}})},i=(e,t,n)=>{let o=[...e];return t>=o.length&&o.push(n),o[t]=n,o},u=e=>new URL(e).hostname,d=e=>!!e&&""!==e&&-1!==e.indexOf("!")&&-1!==e.indexOf("!os"),h=e=>{if(!e||""===e||-1===e.indexOf("!"))return null;let t=Object.values(s.RW);t.sort((e,t)=>t.shortcut.length-e.shortcut.length);let n=e.split(" ");for(let o=0;o<t.length;o+=1){let{shortcut:r,url:a}=t[o],s="!".concat(r),c="".concat(r,"!");if(-1!==n.indexOf(s)){let t=e.replace(s,""),n="".concat(a).concat(encodeURIComponent(t));return n}if(-1!==n.indexOf(c)){let t=e.replace(c,""),n="".concat(a).concat(encodeURIComponent(t));return n}}return null},f=(e,t)=>e.replace(/[\(\[]Source\s*\d+(,\s*Source\s*\d+)*[\)\]](?!\()|\[\^\d+\^\]|(\[\^[a-z0-9]+\.[\w-]+(\.[\w-]+)*\^\])/gi,(e,n)=>{let o=e.match(/\d+/g);if(!o)return console.error("no source numbers",e),e;let r=o.map(e=>parseInt(e,10)),a=r.map(e=>{if(t&&e<t.length){let n=t[e];return n}return""}),s=a.filter(e=>e),c=s.map((e,t)=>"[[".concat(o[t],"]](").concat(e,")"));return c.join(" ")}),m=/Source (\d+)/g,p=(e,t,n)=>{let o="".concat(e,"\n").concat(t);o.length>s.$x?window.location.href="/agent?source=searchbox":(w(o,n)>s.CZ&&(o=j(o,s.CZ,n)),window.location.href="/agent?q=".concat(encodeURIComponent(o),"&source=searchbox"))},x=(e,t)=>{let n={...e};return Object.keys(t).forEach(e=>{Object.keys(n).includes(e)?"object"==typeof t[e]?n[e]=x(n[e],t[e]):n[e]+=t[e]:n[e]=t[e]}),n},b=(e,t)=>{let n=t.id,{delta:o}=t.choices[0];if(Object.keys(e).includes(n)){let t=x(e[n].choices[0].delta,o);return{...e,[n]:{...e[n],choices:[{delta:t}]}}}return{...e,[n]:t}},g=e=>Object.values(e).sort((e,t)=>e.created-t.created).map(e=>{let{delta:t}=e.choices[0],{role:n,content:o,function_call:r,name:a,metadata:s}=t,c=null==s?void 0:s.web_results,l={role:n,content:o,functionCall:r,name:a,metadata:{...s,webResults:c}};return l}),y=(e,t)=>t?"Phind Plus"===e?s.de:"Phind Pro"===e||"Phind Pro Yearly"===e?s.Ln:s.BY:s.BY;function w(e,t){return"Phind Model"===t?r.Z.encode(e).length:("GPT-4"!==t&&"GPT-3.5-Turbo"!==t&&a.uT("Trying to tokenize with unknown model: ".concat(t)),o.ZP.encode(e,{disallowedSpecial:new Set}).length)}function j(e,t,n){if("Phind Model"===n)return r.Z.decode(r.Z.encode(e).splice(0,t));"GPT-4"!==n&&"GPT-3.5-Turbo"!==n&&a.uT("Trying to tokenize with unknown model: ".concat(n));let s=o.ZP.encode(e,{disallowedSpecial:new Set});return o.ZP.decode(s.splice(0,t))}},91745:function(e,t,n){n.d(t,{Z:function(){return r}});var o=n(67294);function r(e,t){let[n,r]=(0,o.useState)(t);return(0,o.useEffect)(()=>{let n=localStorage.getItem(e);null===n?"function"==typeof t?r(t()):r(t):r(JSON.parse(n))},[]),(0,o.useEffect)(()=>{localStorage.setItem(e,JSON.stringify(n))},[n]),[n,r]}}}]);